<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="21007" />


<title>intro</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">intro</h1>
<h4 class="author">21007</h4>
<h4 class="date">2021/12/16</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p><strong>StatComp21007</strong> is a simple R package including all homework and two SCAD functions. <em>SCAD_cv</em> uses cross-validation method to select the penalty coefficient <span class="math inline">\(\lambda\)</span> for SCAD penalty function. <em>SCAD_Function</em> is used for variable selection and parameter determination. Both functions are for classical linear model.</p>
<p>These algorithms and theories come from <span class="math inline">\(Fan &amp; Li: Nonconcave Penalized Likelihood\)</span>.</p>
</div>
<div id="algorithm" class="section level2">
<h2>Algorithm</h2>
<p><strong>Cross-Validation</strong></p>
<p>In <em>SCAD_cv</em> , we use leave-one-out cross-validation.</p>
<p>Cross-Validation score can be expressed as <span class="math display">\[CV = \frac{1}{n}\sum_{i=1}^{n}(\frac{y-\hat{y}_i}{1-H_{ii}})^2\]</span></p>
<p>Where <span class="math inline">\(H=X(X^TX)^{-1}X^T\)</span>, <span class="math inline">\(\hat{y}_i\)</span> is the predicted value of the model based on the whole data.</p>
<p><strong>SCAD iterative process</strong></p>
<p>The objective function is as follows: <span class="math display">\[\frac{1}{2}(y-X\beta)&#39;(y-X\beta)+n\sum_{j=1}^{d}p_{\lambda}(|\beta_j|)\]</span> Where <span class="math display">\[p_{\lambda}&#39;(\theta)=\lambda(I(\theta \le \lambda)+\frac{(a\lambda-\theta)_+}{(a-1)\lambda}I(\theta&gt;\lambda))  , a&gt;0 , \lambda&gt;0\]</span> Iterative process:</p>
<p><span class="math display">\[{\beta_j}^{(k)}={\beta_j}^{(k-1)}-[\frac{\partial ^2l(\beta)}{\partial{\beta_j}^2}]^{-1}\frac{\partial l(\beta)}{\partial \beta_j}\]</span> <em>SCAD_cv</em></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>SCAD_cv <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, A) {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#to define SCAD penalty derivative</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  pen_der<span class="ot">&lt;-</span><span class="cf">function</span>(theta,<span class="at">a =</span> <span class="fl">3.7</span>,lambda){</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(theta) <span class="sc">&gt;</span> lambda){</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(a <span class="sc">*</span> lambda <span class="sc">&gt;</span> theta){</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>((a <span class="sc">*</span> lambda <span class="sc">-</span> theta)<span class="sc">/</span>(a <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(lambda)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Initialization coefficient</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  b_ls <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(y<span class="sc">~</span>X)<span class="sc">$</span>coefficients</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#the maximum iterations  </span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  max_iteration<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#A column 1 is added before X to facilitate the processing of intercept items</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  inter_y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>,<span class="at">nrow =</span> <span class="fu">length</span>(y),<span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(inter_y,X)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  H <span class="ot">&lt;-</span> X <span class="sc">%*%</span> <span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X) <span class="sc">%*%</span> <span class="fu">t</span>(X)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  CV_score <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(A))</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(A)){</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  b0 <span class="ot">&lt;-</span> b_ls</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  ll <span class="ot">&lt;-</span> A[i]</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  iteration<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(iteration <span class="sc">&lt;</span> max_iteration){</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(b0)){</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">abs</span>(b0[j]) <span class="sc">&lt;</span> <span class="fl">1e-06</span>){</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">next</span>()</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        nominator<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="sc">-</span> X[,j] <span class="sc">*</span> (y <span class="sc">-</span> X <span class="sc">%*%</span> b0)) <span class="sc">+</span> <span class="fu">nrow</span>(X)<span class="sc">*</span>b0[j]<span class="sc">*</span><span class="fu">pen_der</span>(<span class="at">theta =</span> b0[j],<span class="at">lambda =</span>ll)<span class="sc">/</span><span class="fu">abs</span>(b0[j])</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>        denominator<span class="ot">&lt;-</span> <span class="fu">sum</span>(X[,j]<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">nrow</span>(X)<span class="sc">*</span><span class="fu">pen_der</span>(<span class="at">theta =</span> b0[j],<span class="at">lambda =</span>ll)<span class="sc">/</span><span class="fu">abs</span>(b0[j])</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>        b0[j]<span class="ot">&lt;-</span>b0[j] <span class="sc">-</span> nominator<span class="sc">/</span>denominator</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">abs</span>(b0[j]) <span class="sc">&lt;</span> <span class="fl">1e-06</span>){</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>          b0[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    iteration <span class="ot">&lt;-</span> iteration<span class="sc">+</span><span class="dv">1</span> </span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  y_hat <span class="ot">&lt;-</span> X <span class="sc">%*%</span> b0</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y)){</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">=</span> s <span class="sc">+</span> ((y[k]<span class="sc">-</span>y_hat[k])<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>H[k,k]))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  CV_score[i] <span class="ot">&lt;-</span> s<span class="sc">/</span><span class="fu">length</span>(y)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(A)){</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(CV_score[<span class="fu">length</span>(A)<span class="sc">-</span>i<span class="sc">+</span><span class="dv">1</span>] <span class="sc">&lt;</span> <span class="dv">1</span>){</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>      index<span class="ot">=</span>(<span class="fu">length</span>(A)<span class="sc">-</span>i<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( A[index])</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><em>SCAD_Function</em></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>SCAD_Function <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#to find the best lambda by cv</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  b0<span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(y<span class="sc">~</span>X)<span class="sc">$</span>coefficients</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  qq <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">abs</span>(b0))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(qq <span class="sc">&gt;</span> <span class="dv">50</span>){</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    A <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,qq,<span class="dv">1</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    A <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,qq,<span class="fl">0.1</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  cv_lambda <span class="ot">&lt;-</span> <span class="fu">SCAD_cv</span>(X,y,A)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#to define SCAD penalty</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  pen_fun<span class="ot">&lt;-</span><span class="cf">function</span>(theta,<span class="at">lambda =</span> cv_lambda){</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    p_lambda<span class="ot">&lt;-</span><span class="fu">sapply</span>(theta, <span class="cf">function</span>(x){</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">abs</span>(x)<span class="sc">&lt;</span> lambda){</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(lambda<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> (<span class="fu">abs</span>(x) <span class="sc">-</span> lambda)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(lambda<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(p_lambda)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#to define SCAD penalty derivative</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  pen_der<span class="ot">&lt;-</span><span class="cf">function</span>(theta,<span class="at">a =</span> <span class="fl">3.7</span>,<span class="at">lambda =</span> cv_lambda){</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(theta) <span class="sc">&gt;</span> lambda){</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(a <span class="sc">*</span> lambda <span class="sc">&gt;</span> theta){</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>((a <span class="sc">*</span> lambda <span class="sc">-</span> theta)<span class="sc">/</span>(a <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(lambda)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Initialization coefficient</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  b0<span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(y<span class="sc">~</span>X)<span class="sc">$</span>coefficients</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Iteration counter</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  iteration<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="co">#the maximum iterations  </span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  max_iteration<span class="ot">&lt;-</span><span class="dv">100000</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  <span class="co">#A column 1 is added before X to facilitate the processing of intercept items</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  inter_y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>,<span class="at">nrow =</span> <span class="fu">length</span>(y),<span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(inter_y,X)</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  <span class="co">#SCAD iterative process</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(iteration <span class="sc">&lt;</span> max_iteration){</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(b0)){</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">abs</span>(b0[j]) <span class="sc">&lt;</span> <span class="fl">1e-06</span>){</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">next</span>()</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>        <span class="co">#nominator</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>        nominator<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="sc">-</span> X[,j] <span class="sc">*</span> (y <span class="sc">-</span> X <span class="sc">%*%</span> b0)) <span class="sc">+</span> <span class="fu">nrow</span>(X)<span class="sc">*</span>b0[j]<span class="sc">*</span><span class="fu">pen_der</span>(<span class="at">theta =</span> b0[j])<span class="sc">/</span><span class="fu">abs</span>(b0[j])</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>        <span class="co">#denominator__the second derivative</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>        denominator<span class="ot">&lt;-</span> <span class="fu">sum</span>(X[,j]<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">nrow</span>(X)<span class="sc">*</span><span class="fu">pen_der</span>(<span class="at">theta =</span> b0[j])<span class="sc">/</span><span class="fu">abs</span>(b0[j])</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Iterate b0[j]</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>        b0[j]<span class="ot">&lt;-</span>b0[j] <span class="sc">-</span> nominator<span class="sc">/</span>denominator</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>        <span class="co">#If b0[j] is small, make it equal to 0.</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">abs</span>(b0[j]) <span class="sc">&lt;</span> <span class="fl">1e-06</span>){</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>          b0[j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>    iteration <span class="ot">&lt;-</span> iteration<span class="sc">+</span><span class="dv">1</span> </span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b0)</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ncvreg)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>Simu_Multi_Norm<span class="ot">&lt;-</span><span class="cf">function</span>(x_len, <span class="at">sd =</span> <span class="dv">1</span>, <span class="at">pho =</span> <span class="fl">0.5</span>){</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  V <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">nrow =</span> x_len, <span class="at">ncol =</span> x_len)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>x_len){ </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>x_len){ </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>      V[i,j] <span class="ot">&lt;-</span> pho<span class="sc">^</span><span class="fu">abs</span>(i<span class="sc">-</span>j)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  V<span class="ot">&lt;-</span>(sd<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> V</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(V)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">60</span>, <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="fu">Simu_Multi_Norm</span>(<span class="at">x_len =</span> <span class="dv">8</span>,<span class="at">sd  =</span> <span class="dv">1</span>, <span class="at">pho =</span> <span class="fl">0.5</span>))</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="fl">0.02</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">10</span>,<span class="fl">0.05</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span> X <span class="sc">%*%</span> beta <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">60</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="fl">0.1</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="fu">SCAD_cv</span>(X,y,A)</span></code></pre></div>
<pre><code>## [1] 0.2</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">cv.ncvreg</span>(X,y,<span class="at">penalty=</span><span class="st">&#39;SCAD&#39;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>B<span class="sc">$</span>lambda.min</span></code></pre></div>
<pre><code>## [1] 0.1274401</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">SCAD_Function</span>(X,y)</span></code></pre></div>
<pre><code>## (Intercept)          X1          X2          X3          X4          X5 
##   0.0000000   0.9273742   0.3897171   0.0000000   0.0000000   2.0029358 
##          X6          X7          X8 
##   0.0000000   9.9797247   0.0000000</code></pre>
</div>
<div id="homework0" class="section level2">
<h2>Homework0</h2>
<p>Use knitr to produce at least 3 examples (texts, figures, tables).</p>
<p>1.texts: Statistical calculation is an interdisciplinary subject of mathematical statistics, computational mathematics and computer science. This is the first job of statistical calculation.</p>
<p>2.Mathematical formula: <span class="math inline">\(e^{i\theta}=\cos\theta+i\sin\theta\)</span></p>
<p>3.figures:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>A<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">172</span>,<span class="dv">170</span>,<span class="dv">180</span>,<span class="dv">175</span>,<span class="dv">188</span>,<span class="dv">168</span>,<span class="dv">177</span>,<span class="dv">183</span>,<span class="dv">173</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">80</span>,<span class="dv">75</span>,<span class="dv">60</span>,<span class="dv">85</span>,<span class="dv">70</span>,<span class="dv">68</span>,<span class="dv">77</span>,<span class="dv">63</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(A,B,<span class="at">xlab=</span><span class="st">&quot;Height/cm&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Weight/kg&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">160</span>,<span class="dv">200</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">55</span>,<span class="dv">90</span>),<span class="at">main=</span><span class="st">&quot;Height and weight of 9 boys in a class&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>4.tables:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">15</span>),<span class="dv">5</span>,<span class="dv">3</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(a)<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="cn">NULL</span>,<span class="fu">c</span>(<span class="st">&quot;Group one&quot;</span>,<span class="st">&quot;Group two&quot;</span>,<span class="st">&quot;Group three&quot;</span>))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(a))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Group one</th>
<th align="right">Group two</th>
<th align="right">Group three</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.2073655</td>
<td align="right">0.6909898</td>
<td align="right">0.4018139</td>
</tr>
<tr class="even">
<td align="right">0.4592408</td>
<td align="right">0.2869576</td>
<td align="right">0.6485563</td>
</tr>
<tr class="odd">
<td align="right">0.2415023</td>
<td align="right">0.1494125</td>
<td align="right">0.9163057</td>
</tr>
<tr class="even">
<td align="right">0.1186903</td>
<td align="right">0.9724320</td>
<td align="right">0.2166621</td>
</tr>
<tr class="odd">
<td align="right">0.0724691</td>
<td align="right">0.4105144</td>
<td align="right">0.5479989</td>
</tr>
</tbody>
</table>
</div>
<div id="homework1" class="section level2">
<h2>Homework1</h2>
<p>Exercises 3.4, 3.11, and 3.20 (pages 94-96, Statistical Computating with R).</p>
<p><strong>3.4</strong></p>
<p>Firstly, we integrate the probability density function to obtain the probability distribution function <span class="math display">\[F(x)=1-e^{-x^2/(2σ^2)} , x≥0 , σ&gt;0\]</span> Because <span class="math inline">\(X\)</span> is a continuous random variable, <span class="math inline">\(F(X)\)</span> is a uniform distribution <span class="math inline">\(U(0,1)\)</span>.We can get <span class="math display">\[X=\sqrt{(-2σ^2\ln(1-U))}\]</span> Finally, we use the inverse transform method to solve this problem.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>; qq <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(qq<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">runif</span>(n)))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;f(x),when qq=1&quot;</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="dv">0</span>, <span class="dv">5</span>, .<span class="dv">01</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Y, (Y<span class="sc">/</span>(qq<span class="sc">^</span><span class="dv">2</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(Y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>qq<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>; qq <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(qq<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">runif</span>(n)))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;f(x),when qq=2&quot;</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="dv">0</span>, <span class="dv">10</span>, .<span class="dv">01</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Y, (Y<span class="sc">/</span>(qq<span class="sc">^</span><span class="dv">2</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(Y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>qq<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>; qq<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(qq<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">runif</span>(n)))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;f(x),when qq=3&quot;</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="dv">0</span>, <span class="dv">15</span>, .<span class="dv">01</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Y, (Y<span class="sc">/</span>(qq<span class="sc">^</span><span class="dv">2</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(Y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>qq<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>; qq<span class="ot">=</span><span class="dv">4</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(qq<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">runif</span>(n)))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;f(x),when qq=4&quot;</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="dv">0</span>, <span class="dv">20</span>, .<span class="dv">01</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Y, (Y<span class="sc">/</span>(qq<span class="sc">^</span><span class="dv">2</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(Y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>qq<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> As we can be seen from the figures, when <span class="math inline">\(σ\)</span> takes different values, the modes of the generated samples are all very close to the theoretical modes.</p>
<p><strong>3.11</strong></p>
<p>Firstly, we generate 1000 random numbers subject to <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(3,1)\)</span> distributions.Then, we combine the two groups of random numbers in terms of the mixing probability.</p>
<p>Let <span class="math inline">\(P_1\)</span> take <span class="math inline">\(0.75\)</span>, we can get the following figure. <img src="data:image/png;base64,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" /><!-- --> Repeat with different values for <span class="math inline">\(p_1\)</span> and observe whether the empirical distribution of the mixture appears to be bimodal.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span> ; </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>Z1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>Z2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>k1 <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(A1 <span class="sc">&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> k1 <span class="sc">*</span> Z1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>k1) <span class="sc">*</span> Z2</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>A2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>k2 <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(A2 <span class="sc">&lt;</span> <span class="fl">0.25</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> k2 <span class="sc">*</span> Z1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>k2) <span class="sc">*</span> Z2</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>k3 <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(A3 <span class="sc">&lt;</span> <span class="fl">0.9</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> k3 <span class="sc">*</span> Z1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>k3) <span class="sc">*</span> Z2</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>A4 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>k4 <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(A4 <span class="sc">&lt;</span> <span class="fl">0.1</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>X4 <span class="ot">&lt;-</span> k4 <span class="sc">*</span> Z1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>k4) <span class="sc">*</span> Z2</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X1, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="fu">expression</span>(p[<span class="dv">1</span>]<span class="sc">==</span><span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X2, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="fu">expression</span>(p[<span class="dv">1</span>]<span class="sc">==</span><span class="fl">0.25</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X3, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="fu">expression</span>(p[<span class="dv">1</span>]<span class="sc">==</span><span class="fl">0.9</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X4, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="fu">expression</span>(p[<span class="dv">1</span>]<span class="sc">==</span><span class="fl">0.1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> By observing the figures generated by different <span class="math inline">\(p_1\)</span>, we can find that the closer <span class="math inline">\(p_1\)</span> is to <span class="math inline">\(0.5\)</span>, the more obvious the bimodal mixtures are.</p>
<p><strong>3.20</strong></p>
<p>Firstly, we need to take a sample <span class="math inline">\(N(t)\)</span> from the Poisson(<span class="math inline">\(\lambda\)</span>) process. Then, we take <span class="math inline">\(N(t)\)</span> samples from the gamma distribution <span class="math inline">\(Gamma(r,\beta)\)</span> and add the values of these samples together.Repeat the above process <span class="math inline">\(n\)</span> times.</p>
<p>According to the hint, we can know <span class="math display">\[E(X(t))=\lambda tE(Y_1)=\lambda t \frac{r}{\beta}\]</span> <span class="math display">\[Var(X(t))=\lambda tE(Y_1^2)=\lambda t \frac{r(r+1)}{\beta^2}\]</span> In the end, estimate the mean and the variance of <span class="math inline">\(X(10)\)</span> for several choices of the parameters and compare with the theoretical values.</p>
<p>When <span class="math inline">\(\lambda=2,r=3,\beta=4\)</span>, <span class="math display">\[E(X(t))=15,Var(X(t))=15\]</span> The mean and variance of the sample are as follows:</p>
<pre><code>## [1] 15.05052</code></pre>
<pre><code>## [1] 14.39862</code></pre>
<p>When <span class="math inline">\(\lambda=5,r=6,\beta=10\)</span> <span class="math display">\[E(X(t))=30,Var(X(t))=21\]</span> The mean and variance of the sample are as follows:</p>
<pre><code>## [1] 30.13905</code></pre>
<pre><code>## [1] 20.34982</code></pre>
<p>As we can see, the estimates of the mean and variance are very close to the theoretical values.</p>
</div>
<div id="homework2" class="section level2">
<h2>Homework2</h2>
<p>Exercises 5.4, 5.9, 5.13, and 5.14 (pages 149-151, Statistical Computating with R).</p>
<p><strong>5.4</strong></p>
<p>The Cumulative distribution function (CDF) of Beta(3,3) is <span class="math display">\[F(x)=\int_{0}^{x}\frac{1}{B(3,3)}x^2(1-x)^2\,dx ,  0\le x\le 1\]</span> Where, <span class="math display">\[B(3,3)=\int_{0}^{1}x^2(1-x)^2\,dx=\frac{1}{30}\]</span> Compare the Monte Carlo estimates with the values returned by the pbeta function for x=0.1,0.2, … ,0.9.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>;</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span>x);</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">mean</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>a)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>x</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">9</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">9</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  c[i]<span class="ot">=</span><span class="fu">f</span>(i<span class="sc">/</span><span class="dv">10</span>)<span class="sc">*</span><span class="dv">30</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  d[i]<span class="ot">=</span><span class="fu">pbeta</span>(i<span class="sc">/</span><span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span><span class="fu">c</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">rbind</span>(e,c,d)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(p) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;estimates&quot;</span>,<span class="st">&quot;pbeta&quot;</span>)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(p))</span></code></pre></div>
<table>
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="9%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="9%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left">x</td>
<td align="right">0.1000000</td>
<td align="right">0.2000000</td>
<td align="right">0.3000000</td>
<td align="right">0.4000000</td>
<td align="right">0.500000</td>
<td align="right">0.6000000</td>
<td align="right">0.7000000</td>
<td align="right">0.8000000</td>
<td align="right">0.900000</td>
</tr>
<tr class="even">
<td align="left">estimates</td>
<td align="right">0.0083977</td>
<td align="right">0.0579704</td>
<td align="right">0.1646767</td>
<td align="right">0.3088176</td>
<td align="right">0.488525</td>
<td align="right">0.6943345</td>
<td align="right">0.8586401</td>
<td align="right">0.9613226</td>
<td align="right">1.030116</td>
</tr>
<tr class="odd">
<td align="left">pbeta</td>
<td align="right">0.0085600</td>
<td align="right">0.0579200</td>
<td align="right">0.1630800</td>
<td align="right">0.3174400</td>
<td align="right">0.500000</td>
<td align="right">0.6825600</td>
<td align="right">0.8369200</td>
<td align="right">0.9420800</td>
<td align="right">0.991440</td>
</tr>
</tbody>
</table>
<p>As we can see, the estimates are very close to the values returned by the pbeta function.</p>
<p><strong>5.9</strong></p>
<p>Firstly, we integrate the probability density function to obtain the probability distribution function <span class="math display">\[F(x)=1-e^{-x^2/(2σ^2)} , x≥0 , σ&gt;0\]</span> Because <span class="math inline">\(X\)</span> is a continuous random variable, <span class="math inline">\(F(X)\)</span> is a uniform distribution <span class="math inline">\(U(0,1)\)</span>.We can get <span class="math display">\[X=\sqrt{(-2σ^2\ln(1-U))}\]</span></p>
<p>The antithetic variable is <span class="math display">\[X&#39;=\sqrt{(-2σ^2\ln(U))}\]</span></p>
<p>We take different values for <span class="math inline">\(\sigma\)</span> to calculate the percent reduction in variance.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>rf <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">1000</span>;</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>a))</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  X_anti <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(a))</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>a))</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>b))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> <span class="fu">var</span>((X<span class="sc">+</span>X_anti)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="fu">var</span>((X1<span class="sc">+</span>X2)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((f<span class="sc">-</span>e)<span class="sc">/</span>f)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">10</span>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  h[i] <span class="ot">&lt;-</span> <span class="fu">rf</span>(i)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">rbind</span>(g,h)</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">round</span>(k,<span class="dv">3</span>)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(k) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;σ&quot;</span>,<span class="st">&quot;reduction in var&quot;</span>)</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(k))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">σ</td>
<td align="right">1.000</td>
<td align="right">2.000</td>
<td align="right">3.000</td>
<td align="right">4.000</td>
<td align="right">5.000</td>
<td align="right">6.00</td>
<td align="right">7.000</td>
<td align="right">8.000</td>
<td align="right">9.000</td>
<td align="right">10.000</td>
</tr>
<tr class="even">
<td align="left">reduction in var</td>
<td align="right">0.958</td>
<td align="right">0.928</td>
<td align="right">0.943</td>
<td align="right">0.945</td>
<td align="right">0.956</td>
<td align="right">0.94</td>
<td align="right">0.953</td>
<td align="right">0.953</td>
<td align="right">0.947</td>
<td align="right">0.953</td>
</tr>
</tbody>
</table>
<p>As we can see, no matter what the value of <span class="math inline">\(sigma\)</span> is, the percent reduction in variance of <span class="math inline">\(\frac{X+X&#39;}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span> are all very close to <span class="math inline">\(94.7\%\)</span>.</p>
<p><strong>5.13</strong></p>
<p>We can find two importance functions <span class="math display">\[f_1=e^{-x},x&gt;1\]</span> <span class="math display">\[f_2=\frac{1}{\sqrt{2\pi}}e^{-\frac{(x-1.65)^2}{2}},x&gt;1\]</span></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> (x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="dv">1</span>)    <span class="co">#using f1</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="fl">1.65</span>,<span class="dv">1</span>)   <span class="co">#using f2</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>(x<span class="fl">-1.65</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">rbind</span>(theta.hat,se)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(c) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;f&#39;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(c)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">f1</th>
<th align="right">f2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">theta.hat</td>
<td align="right">0.3797122</td>
<td align="right">0.3788629</td>
</tr>
<tr class="even">
<td align="left">se</td>
<td align="right">0.5729378</td>
<td align="right">0.2955832</td>
</tr>
</tbody>
</table>
<p>As we can see, <span class="math display">\[f_2=\frac{1}{\sqrt{2\pi}}e^{-\frac{(x-1.65)^2}{2}},x&gt;1\]</span> produce the smaller variance in estimating <span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}\,dx\]</span></p>
<p><strong>5.14</strong></p>
<p>From 5.13, we can know that <span class="math display">\[f_2=\frac{1}{\sqrt{2\pi}}e^{-\frac{(x-1.65)^2}{2}},x&gt;1\]</span> is an importance function with smaller variance.So we use <span class="math inline">\(f_2\)</span> to estimate <span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}\,dx\]</span></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> (x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="fl">1.65</span>,<span class="dv">1</span>)   <span class="co">#using f2</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>(x<span class="fl">-1.65</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(fg)</span></code></pre></div>
<pre><code>## [1] 0.40521</code></pre>
<p>As we can see, the Monte Carlo estimate of <span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}\,dx\]</span> by importance sampling is close to <span class="math inline">\(0.4\)</span>.</p>
</div>
<div id="homework3" class="section level2">
<h2>Homework3</h2>
<p>Exercises 6.5 and 6.A (page 180-181, Statistical Computating with R).</p>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.</p>
<p>(1)What is the corresponding hypothesis test problem?</p>
<p>(2)What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?</p>
<p>(3)Please provide the least necessary information for hypothesis testing.</p>
<p><strong>6.5</strong></p>
<p>As we all know, <span class="math display">\[\frac{\bar{x}-u}{S}\sqrt{n}\sim t(n-1)\]</span> So the <span class="math inline">\(1-\alpha\)</span> confidence interval of the mean is <span class="math display">\[(\bar{x}-\frac{t_{\frac{\alpha}{2}}(n-1)S}{\sqrt{n}},\bar{x}+\frac{t_{\frac{\alpha}{2}}(n-1)S}{\sqrt{n}})\]</span> The coverage probability can be approximated by <span class="math display">\[\frac{1}{m} \sum\limits_{j=1}^mI(\hat{\theta}_1^{(j)}&lt;\theta&lt;\hat{\theta}_2^{(j)})\]</span> Where <span class="math inline">\((\hat{\theta}_1^{(j)},\hat{\theta}_2^{(j)})\)</span> is the CI of <span class="math inline">\(\theta\)</span> in the <span class="math inline">\(j\)</span>th MC experiment.</p>
<p>We take random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n=20\)</span>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span>;alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">1000</span>) ;b <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">2</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  a[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x))<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  b[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x))<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>( a<span class="sc">&gt;</span><span class="dv">2</span> <span class="sc">&amp;</span> b<span class="sc">&lt;</span><span class="dv">2</span> )</span></code></pre></div>
<pre><code>## [1] 0.932</code></pre>
<p>The estimate of the CP of the t-interval is around <span class="math inline">\(0.93\)</span>, which is smaller than <span class="math inline">\(0.95\)</span>.</p>
<p>Compared with Example 6.4, the t-interval is more robust to departures from normality than the interval for variance.</p>
<p><strong>6.A</strong></p>
<p>It is calculated that the mean of <span class="math inline">\(\chi^2(1)\)</span>, <span class="math inline">\(Uniform(0,2)\)</span> and <span class="math inline">\(Exponential(1)\)</span> are the same: <span class="math display">\[u_0=1\]</span></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10000</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span>;alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>;u<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>) ;b <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>) ;c <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  ttest1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">mu=</span>u)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  a[i] <span class="ot">&lt;-</span> ttest1<span class="sc">$</span>p.value</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  ttest2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y,<span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">mu=</span>u)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  b[i] <span class="ot">&lt;-</span> ttest2<span class="sc">$</span>p.value</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  ttest3 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(z,<span class="at">mu=</span>u)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  c[i] <span class="ot">&lt;-</span> ttest3<span class="sc">$</span>p.value</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> e <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>d[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(a<span class="sc">&lt;</span>alpha)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>d[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(b<span class="sc">&lt;</span>alpha)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>d[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(c<span class="sc">&lt;</span>alpha)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>e[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(d[<span class="dv">1</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>d[<span class="dv">1</span>])<span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>e[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(d[<span class="dv">2</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>d[<span class="dv">2</span>])<span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>e[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(d[<span class="dv">3</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>d[<span class="dv">3</span>])<span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span> <span class="fu">rbind</span>(d,e)</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(p) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;alpha.hat&quot;</span>,<span class="st">&quot;se.hat&quot;</span>)</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(p) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;卡方(1)&quot;</span>,<span class="st">&quot;Uniform(0,2)&quot;</span>,<span class="st">&quot;Exponential(1)&quot;</span>)</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(p)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">卡方(1)</th>
<th align="right">Uniform(0,2)</th>
<th align="right">Exponential(1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha.hat</td>
<td align="right">0.0500000</td>
<td align="right">0.0300000</td>
<td align="right">0.0700000</td>
</tr>
<tr class="even">
<td align="left">se.hat</td>
<td align="right">0.0217945</td>
<td align="right">0.0170587</td>
<td align="right">0.0255147</td>
</tr>
</tbody>
</table>
<p>As we can see, the t-test is robust to mild departures from normality.</p>
<p><strong>3</strong></p>
<p>3.1 <span class="math display">\[H_0: power_1=power_2\quad (The\ powers\ are\ the\ same\ at\ 0.05\ level.)\]</span> <span class="math display">\[H_1: power_1\neq power_2\quad (The\ powers\ are\ different\ at\ 0.05\ level.)\]</span> Where <span class="math inline">\(power_1\)</span> and <span class="math inline">\(power_2\)</span> stand for the powers for two methods under a particular simulation setting with 10,000 experiments.</p>
<p>3.2</p>
<p>I think paired-t test is the best choice.</p>
<p>As for two-sample t-test, it requires two sets of samples to be independent, but this subject does not meet this condition. As for Z-test and McNemar test, they are better for large samples.</p>
<p>3.3</p>
<p>We should know the following four messages:</p>
<p><span class="math inline">\(n\)</span>:The number of repeated tests. Then we can get n <span class="math inline">\(power_1\)</span> and n <span class="math inline">\(power_2\)</span>.</p>
<p><span class="math inline">\(\bar{power_1}\)</span>:Then mean of <span class="math inline">\(power_1\)</span>.</p>
<p><span class="math inline">\(\bar{power_2}\)</span>:Then mean of <span class="math inline">\(power_2\)</span>.</p>
<p><span class="math inline">\(S_{power_1-power_2}\)</span>:The standard deviation of <span class="math inline">\(power_1-power_2\)</span>.</p>
<p>Last, we can use the four messages to do paired-t test.</p>
</div>
<div id="homework4" class="section level2">
<h2>Homework4</h2>
<p>Exercises 6.C (pages 182, Statistical Computating with R).</p>
<p><strong>6.C</strong></p>
<p>Firstly, Repeat <strong>Examples 6.8</strong> for Mardia’s multivariate skewness test.</p>
<p>We take <span class="math inline">\(d=2\)</span>,<span class="math inline">\(\alpha=0.05\)</span>, <span class="math display">\[X \sim N(0,0 ; 1,2 ; 0)\]</span></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">29999</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)        </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">rbind</span>(v1,v2)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>cr <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.95</span> , d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>T1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){          </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">nrow</span>(x)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n,d)      </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d){</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>       x1[,i]<span class="ot">&lt;-</span>x[,i]<span class="sc">-</span><span class="fu">mean</span>(x[,i])</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  covbar <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,d,d)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    covbar <span class="ot">&lt;-</span> covbar <span class="sc">+</span> <span class="fu">outer</span>(x1[i,],x1[i,])</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  covbar <span class="ot">&lt;-</span> covbar<span class="sc">/</span>n </span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  nicovbar <span class="ot">&lt;-</span> <span class="fu">solve</span>(covbar)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>  b_id <span class="ot">&lt;-</span> <span class="dv">0</span>                </span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>      b_id <span class="ot">&lt;-</span> b_id <span class="sc">+</span> (x1[i,]<span class="sc">%*%</span>nicovbar<span class="sc">%*%</span>x1[j,])<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>  b_id <span class="ot">&lt;-</span> b_id <span class="sc">/</span> (n<span class="sc">*</span>n)</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(n<span class="sc">*</span>b_id<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>Tl <span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>    n<span class="ot">&lt;-</span><span class="fu">nrow</span>(x)</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>    x1<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,n,d)</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d){</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>       x1[,i]<span class="ot">&lt;-</span>x[,i]<span class="sc">-</span><span class="fu">mean</span>(x[,i])</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>    covbar<span class="ot">&lt;-</span><span class="fu">t</span>(x1)<span class="sc">%*%</span>x1<span class="sc">/</span>n</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span>x1<span class="sc">%*%</span><span class="fu">solve</span>(covbar)<span class="sc">%*%</span><span class="fu">t</span>(x1)</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>    z<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">colSums</span>(y<span class="sc">^</span>{<span class="dv">3</span>}))<span class="sc">/</span>(n<span class="sc">*</span>n)  </span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(n<span class="sc">*</span>z<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">6</span>)</span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>){</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">&lt;-</span> <span class="fu">numeric</span>(b)</span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>b){</span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n[i],u,v)</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>    s[j] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">abs</span>(<span class="fu">Tl</span>(x)) <span class="sc">&gt;=</span> cr)</span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>  a[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(s)</span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span><span class="fu">rbind</span>(n,a)</span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(q) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;n&quot;</span>,<span class="st">&quot;estimate&quot;</span>)</span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(q))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">n</td>
<td align="right">10</td>
<td align="right">20</td>
<td align="right">30</td>
<td align="right">50.0</td>
<td align="right">100.0</td>
<td align="right">500</td>
</tr>
<tr class="even">
<td align="left">estimate</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.1</td>
<td align="right">0.1</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>As we can see, When n is large enough, the estimates is close to <span class="math inline">\(\alpha=0.05\)</span>.</p>
<p>Secondly, Repeat <strong>Examples 6.10</strong> for Mardia’s multivariate skewness test.</p>
<p>We take <span class="math inline">\(d=2\)</span>,<span class="math inline">\(\alpha=0.1\)</span>, <span class="math display">\[(1-\epsilon)N(0,0 ; 1,1 ; 0)+\epsilon N(0,0;64,64;0), 0 \le \epsilon \le 1\]</span></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">19999</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>afa <span class="ot">=</span> <span class="fl">0.1</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">199</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>ep <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.15</span>,<span class="fl">0.1</span>),<span class="fu">seq</span>(<span class="fl">0.15</span>,<span class="dv">1</span>,<span class="fl">0.5</span>))</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">length</span>(ep)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>po <span class="ot">&lt;-</span> <span class="fu">numeric</span>(L)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>cr <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.9</span>,d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)  </span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,a,d)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>L){       </span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> ep[j]</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">numeric</span>(b)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>b){</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    σ <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">64</span>), <span class="at">replace =</span> T , <span class="at">size =</span> a , <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>q , q) )  </span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>       <span class="cf">for</span>(g <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>a){                                              </span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>         r <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(σ[g],<span class="dv">0</span>,<span class="dv">0</span>,σ[g]),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>         x[g,] <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">1</span>, u, r)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>       }</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    s[i] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">abs</span>(<span class="fu">Tl</span>(x))<span class="sc">&gt;=</span>cr)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>  po[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(s)</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ep,po,<span class="at">type =</span> <span class="st">&quot;b&quot;</span> , <span class="at">xlab =</span> <span class="fu">bquote</span>(ep) , <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))    </span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.1</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>stanerror <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(po<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>po)<span class="sc">/</span>b)</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(ep,po<span class="sc">+</span>stanerror,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(ep,po<span class="sc">-</span>stanerror,<span class="at">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> As we can see, When <span class="math inline">\(\epsilon=0\)</span> or <span class="math inline">\(\epsilon=1\)</span>, the curve intersects <span class="math inline">\(\alpha=0.1\)</span>. When <span class="math inline">\(\epsilon\)</span> is around 0.15, the power reaches the maximum.</p>
</div>
<div id="homework5" class="section level2">
<h2>Homework5</h2>
<p>Exercises 7.7, 7.8, 7.9, and 7.B (pages 213, Statistical Computating with R).</p>
<p><strong>7.7</strong></p>
<p>Firstly, we calculate the sample estimate of <span class="math inline">\(\theta\)</span>.</p>
<p>Secondly, we use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scor,<span class="at">package=</span><span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(scor)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)          </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){                </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  x[i] <span class="ot">=</span> <span class="fu">mean</span>(scor[,i])</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,m,n)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  y[,i]<span class="ot">=</span>scor[,i]<span class="sc">-</span>x[i]</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">t</span>(y)<span class="sc">%*%</span>y<span class="sc">/</span>(m<span class="dv">-1</span>)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">eigen</span>(z)<span class="sc">$</span>values     </span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> a[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(a) </span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>t</span></code></pre></div>
<pre><code>## [1] 0.619115</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10000</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i){       </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> x[i,]</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(y))<span class="sc">$</span>values </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(a)) </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>bhat <span class="ot">=</span> <span class="fu">boot</span>(<span class="at">data =</span> scor, <span class="at">statistic =</span> f, <span class="at">R =</span> <span class="dv">2000</span>)  </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>bis_bo <span class="ot">=</span> <span class="fu">mean</span>(bhat<span class="sc">$</span>t)<span class="sc">-</span>t        </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>se_bo <span class="ot">=</span> <span class="fu">sd</span>(bhat<span class="sc">$</span>t)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>bis_bo</span></code></pre></div>
<pre><code>## [1] 0.002651001</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>se_bo</span></code></pre></div>
<pre><code>## [1] 0.04673587</code></pre>
<p>So, we can get the sample estimate <span class="math inline">\(\hat{\theta}\)</span> is close to <span class="math inline">\(0.62\)</span>. By using bootstrap <span class="math inline">\(B=2000\)</span>, we can get the bis is close to <span class="math inline">\(0.0027\)</span>, the standard error is close to <span class="math inline">\(0.0467\)</span>.</p>
<p><strong>7.8</strong></p>
<p>Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){         </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor[<span class="sc">-</span>i,]))<span class="sc">$</span>values</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> y[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(y)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>bis_ja <span class="ot">=</span> (m<span class="dv">-1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(x)<span class="sc">-</span>t)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>se_ja <span class="ot">=</span> (m<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(x)<span class="sc">/</span>m)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>bis_ja</span></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>se_ja</span></code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
<p>As we can see, by using Jackknife, we can get the bis is close to <span class="math inline">\(0.0011\)</span>, the standard error is close to <span class="math inline">\(0.0496\)</span>.</p>
<p><strong>7.9</strong></p>
<p>Compute <span class="math inline">\(95\%\)</span> percentile and BCa confidence intervals for <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(bhat, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = bhat, type = c(&quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level     Percentile            BCa          
## 95%   ( 0.5253,  0.7084 )   ( 0.5209,  0.7040 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>As we can see, when I take <span class="math inline">\(B=2000\)</span>, the <span class="math inline">\(95\%\)</span> percentile confidence intervals <span class="math inline">\((0.5253,0.7084)\)</span> and the BCa confidence intervals <span class="math inline">\((0.5209,0.7040)\)</span> for <span class="math inline">\(\hat{\theta}\)</span> are very close.</p>
<p><strong>7.B</strong></p>
<p>The skewness of the random variable <span class="math inline">\(X\)</span> is <span class="math display">\[\sqrt{\beta_1}=\frac{E[(X-\mu_X)]^3}{\sigma_X^3}\]</span> Where <span class="math inline">\(\mu_X=E[X]\)</span>, <span class="math inline">\(\sigma_X^2 = Var(X)\)</span>. And skewness statistics of samples is <span class="math display">\[\sqrt{b_1}=\frac{\frac{1}{n}\sum_{i=1}^n(x_i-\bar X)^3}{[\frac{1}{n}\sum_{i=1}^n(x_i-\bar X)^2]^{3/2}}\]</span> Firstly, we consider the normal distribution <span class="math inline">\(N(0,1)\)</span>(skewness 0).</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">30000</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i){   </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">=</span>x[i]</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  ybar <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>((y<span class="sc">-</span>ybar)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> <span class="fu">mean</span>((y<span class="sc">-</span>ybar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p<span class="sc">/</span>(q<span class="sc">^</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">=</span> b1 <span class="ot">=</span> c1 <span class="ot">=</span> <span class="dv">0</span>      </span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">=</span> b2 <span class="ot">=</span> c2 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>a3 <span class="ot">=</span> b3 <span class="ot">=</span> c3 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){      </span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="dv">0</span>               </span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  bhat <span class="ot">=</span> <span class="fu">boot</span>(<span class="at">data =</span> x, <span class="at">statistic =</span> f, <span class="at">R =</span> <span class="dv">500</span>)  </span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">=</span> <span class="fu">boot.ci</span>(bhat, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&lt;</span> ci<span class="sc">$</span>norm[<span class="dv">2</span>]){</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    a1 <span class="ot">=</span> a1 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    c1 <span class="ot">=</span> c1 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&gt;</span> ci<span class="sc">$</span>norm[<span class="dv">3</span>]){</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    b1 <span class="ot">=</span> b1 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>    c1 <span class="ot">=</span> c1 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&lt;</span> ci<span class="sc">$</span>basic[<span class="dv">4</span>]){</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>    a2 <span class="ot">=</span> a2 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>    c2 <span class="ot">=</span> c2 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&gt;</span> ci<span class="sc">$</span>basic[<span class="dv">5</span>]){</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>    b2 <span class="ot">=</span> b2 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>    c2 <span class="ot">=</span> c2 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&lt;</span> ci<span class="sc">$</span>perc[<span class="dv">4</span>]){</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>    a3 <span class="ot">=</span> a3 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>    c3 <span class="ot">=</span> c3 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&gt;</span> ci<span class="sc">$</span>perc[<span class="dv">5</span>]){</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>    b3 <span class="ot">=</span> b3 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>    c3 <span class="ot">=</span> c3 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>c1<span class="sc">/</span><span class="dv">10</span>,a1<span class="sc">/</span><span class="dv">10</span>,b1<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>c2<span class="sc">/</span><span class="dv">10</span>,a2<span class="sc">/</span><span class="dv">10</span>,b2<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>c3<span class="sc">/</span><span class="dv">10</span>,a3<span class="sc">/</span><span class="dv">10</span>,b3<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(A,B,C)</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Z) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>)</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Z) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;covskewneserage rate&quot;</span>,<span class="st">&quot;left miss&quot;</span>,<span class="st">&quot;right miss&quot;</span>)</span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Z))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">covskewneserage rate</th>
<th align="right">left miss</th>
<th align="right">right miss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">norm</td>
<td align="right">0.9</td>
<td align="right">0.1</td>
<td align="right">0.0</td>
</tr>
<tr class="even">
<td align="left">basic</td>
<td align="right">0.8</td>
<td align="right">0.1</td>
<td align="right">0.1</td>
</tr>
<tr class="odd">
<td align="left">perc</td>
<td align="right">1.0</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
</tr>
</tbody>
</table>
<p>As we can see, the coverage rates of the three kinds of confidence intervals are close to <span class="math inline">\(95\%\)</span>. The proportion of times that the confidence intervals miss on the left, and the proportion of times that the confidence intervals miss on the right are very close, both around <span class="math inline">\(0.025\)</span>.</p>
<p>Secondly, we consider <span class="math inline">\(\chi ^2(5)\)</span>(positive skewness).</p>
<p>As we all know, the probability density function of <span class="math inline">\(X \sim \chi ^2(5)\)</span> is <span class="math display">\[f(x)=\frac{1}{3\sqrt{2\pi}}x^{\frac{3}{2}}e^{-\frac{x}{2}}\]</span> And <span class="math inline">\(E(X)=5\)</span>, <span class="math inline">\(Var(X)=10\)</span>, <span class="math inline">\(E(X^2)=Var(X)+[E(X)]^2=35\)</span>. <span class="math display">\[E(X^3)=\int_{0}^{\infty}f(x)*x^3 \, dx \\
      =\int_{0}^{\infty}\frac{1}{3\sqrt{2\pi}}x^{\frac{9}{2}}e^{-\frac{x}{2}} \, dx \\
       =\frac{1}{3\sqrt{2\pi}}*2^{\frac{11}{2}}\int_{0}^{\infty}(\frac{x}{2})^{\frac{11}{2}-1}e^{-\frac{x}{2}} \, d(\frac{x}{2}) \\
       =\frac{1}{3\sqrt{2\pi}}*2^{\frac{11}{2}}*\Gamma(\frac{11}{2})  \\
       =315\]</span> So, the skewness of <span class="math inline">\(\chi ^2(5)\)</span> is <span class="math display">\[\sqrt{\beta_{\chi ^2(5)}}=\frac{E[(X-\mu_X)]^3}{\sigma_X^3} \\
    =\frac{E(X^3)-3E(X)E(X^2)+2[E(X)]^3}{[Var(X)]^\frac{3}{2}} \\
    =\frac{315-3*5*35+2*5^3}{10\sqrt{10}} \\
    =\sqrt{\frac{8}{5}}\]</span></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">30000</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i){       </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">=</span>x[i]</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  ybar <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>((y<span class="sc">-</span>ybar)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> <span class="fu">mean</span>((y<span class="sc">-</span>ybar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p<span class="sc">/</span>(q<span class="sc">^</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">=</span> b1 <span class="ot">=</span> c1 <span class="ot">=</span> <span class="dv">0</span>      </span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">=</span> b2 <span class="ot">=</span> c2 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>a3 <span class="ot">=</span> b3 <span class="ot">=</span> c3 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){  </span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">10</span>,<span class="dv">5</span>)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span>  <span class="fu">sqrt</span>(<span class="fl">1.6</span>)               </span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  bhat <span class="ot">=</span> <span class="fu">boot</span>(<span class="at">data =</span> x, <span class="at">statistic =</span> f, <span class="at">R =</span> <span class="dv">500</span>)  </span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">=</span> <span class="fu">boot.ci</span>(bhat, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&lt;</span> ci<span class="sc">$</span>norm[<span class="dv">2</span>]){</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>    a1 <span class="ot">=</span> a1 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>    c1 <span class="ot">=</span> c1 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&gt;</span> ci<span class="sc">$</span>norm[<span class="dv">3</span>]){</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>    b1 <span class="ot">=</span> b1 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>    c1 <span class="ot">=</span> c1 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&lt;</span> ci<span class="sc">$</span>basic[<span class="dv">4</span>]){</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>    a2 <span class="ot">=</span> a2 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>    c2 <span class="ot">=</span> c2 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&gt;</span> ci<span class="sc">$</span>basic[<span class="dv">5</span>]){</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>    b2 <span class="ot">=</span> b2 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>    c2 <span class="ot">=</span> c2 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&lt;</span> ci<span class="sc">$</span>perc[<span class="dv">4</span>]){</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>    a3 <span class="ot">=</span> a3 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>    c3 <span class="ot">=</span> c3 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&gt;</span> ci<span class="sc">$</span>perc[<span class="dv">5</span>]){</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>    b3 <span class="ot">=</span> b3 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>    c3 <span class="ot">=</span> c3 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>c1<span class="sc">/</span><span class="dv">10</span>,a1<span class="sc">/</span><span class="dv">10</span>,b1<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>c2<span class="sc">/</span><span class="dv">10</span>,a2<span class="sc">/</span><span class="dv">10</span>,b2<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>c3<span class="sc">/</span><span class="dv">10</span>,a3<span class="sc">/</span><span class="dv">10</span>,b3<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(A,B,C)</span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Z) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>)</span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Z) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;coverage rate&quot;</span>,<span class="st">&quot;left miss&quot;</span>,<span class="st">&quot;right miss&quot;</span>)</span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Z))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">coverage rate</th>
<th align="right">left miss</th>
<th align="right">right miss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">norm</td>
<td align="right">0.9</td>
<td align="right">0</td>
<td align="right">0.1</td>
</tr>
<tr class="even">
<td align="left">basic</td>
<td align="right">0.9</td>
<td align="right">0</td>
<td align="right">0.1</td>
</tr>
<tr class="odd">
<td align="left">perc</td>
<td align="right">0.8</td>
<td align="right">0</td>
<td align="right">0.2</td>
</tr>
</tbody>
</table>
<p>As we can see, the coverage rates of the three kinds of confidence intervals are close to <span class="math inline">\(88\%\)</span>. The proportion of times that the confidence intervals miss on the left are so low, lower than <span class="math inline">\(0.01\)</span>. And the proportion of times that the confidence intervals miss on the right are around <span class="math inline">\(0.115\)</span>.</p>
</div>
<div id="homework6" class="section level2">
<h2>Homework6</h2>
<p>Exercise 8.2 (page 242, Statistical Computating with R).</p>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<p>(1)Unequal variances and equal expectations</p>
<p>(2)Unequal variances and unequal expectations</p>
<p>(3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p>
<p>(4)Unbalanced samples (say, 1 case versus 10 controls).Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
<p><strong>8.2</strong></p>
<p>We take <span class="math inline">\(\alpha = 0.05\)</span>.</p>
<p>Firstly, we choose <span class="math display">\[X_1 \sim N(0,1) \\ Y_1=X_1+1\]</span> Obviously, <span class="math inline">\(X_1\)</span> and <span class="math inline">\(Y_1\)</span> are not independent of each other. Then, test it.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>xyCor <span class="ot">&lt;-</span> <span class="cf">function</span>(Z,ix){</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> Z[,<span class="dv">1</span>]</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> Z[ix,<span class="dv">2</span>]</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cor</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">15</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>Y1 <span class="ot">&lt;-</span> X1<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>Z1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X1,Y1)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> Z1, <span class="at">statistic =</span>xyCor, <span class="at">R=</span><span class="dv">999</span>, <span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">c</span>(a1<span class="sc">$</span>t0,a1<span class="sc">$</span>t)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(b1 <span class="sc">&gt;=</span> a1<span class="sc">$</span>t0)</span></code></pre></div>
<pre><code>## [1] 0.001</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X1,Y1)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>c1<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 3.876914e-103</code></pre>
<p>The achieved significance level of the permutation test is close to <span class="math inline">\(0.001\)</span>. The p-value reported by cor.test on the same samples is <span class="math inline">\(3.88*10^{-103}\)</span>. And we take <span class="math inline">\(\alpha = 0.05\)</span>, so we can judge that <span class="math inline">\(X_1\)</span> and <span class="math inline">\(Y_1\)</span> are not independent.</p>
<p>Secondly,we choose <span class="math display">\[X_2 \sim N(0,1) \\ Y_2 \sim \chi^2(2)\]</span> Obviously, <span class="math inline">\(X_2\)</span> and <span class="math inline">\(Y_2\)</span> are independent of each other. Then, test it.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">15</span>,<span class="dv">0</span>,<span class="dv">1</span>)    </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>Y2 <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">15</span>,<span class="dv">2</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>Z2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X2,Y2)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> Z2, <span class="at">statistic =</span>xyCor, <span class="at">R=</span><span class="dv">999</span>, <span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="fu">c</span>(a2<span class="sc">$</span>t0,a2<span class="sc">$</span>t)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(b2 <span class="sc">&gt;=</span> a2<span class="sc">$</span>t0)</span></code></pre></div>
<pre><code>## [1] 0.445</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X2,Y2)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>c2<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.860416</code></pre>
<p>The achieved significance level of the permutation test is close to <span class="math inline">\(0.445\)</span>. The p-value reported by cor.test on the same samples is <span class="math inline">\(0.860\)</span>. And we take <span class="math inline">\(\alpha = 0.05\)</span>, so we can judge that <span class="math inline">\(X_2\)</span> and <span class="math inline">\(Y_2\)</span> are independent.</p>
<p><strong>2.</strong> We take <span class="math inline">\(\alpha = 0.1\)</span>.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.1</span>;</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span>; k<span class="ot">&lt;-</span><span class="dv">3</span>; p<span class="ot">&lt;-</span><span class="dv">2</span>;B<span class="ot">&lt;-</span><span class="dv">99</span>; </span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>L1 <span class="ot">&lt;-</span> L2 <span class="ot">&lt;-</span> <span class="dv">15</span>; L <span class="ot">&lt;-</span> L1<span class="sc">+</span>L2; LL <span class="ot">=</span> <span class="fu">c</span>(L1,L2)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>NN <span class="ot">&lt;-</span> <span class="cf">function</span>(X, ix, sizes,k) {</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  L1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]; L2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]; L <span class="ot">&lt;-</span> L1 <span class="sc">+</span> L2</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(X)) X <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X,<span class="dv">0</span>);</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> X[ix, ];</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>X, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>) </span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  part1 <span class="ot">&lt;-</span> Y<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>L1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  part2 <span class="ot">&lt;-</span> Y<span class="sc">$</span>nn.idx[(L1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>L,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="fu">sum</span>(part1 <span class="sc">&lt;=</span> L1); j <span class="ot">&lt;-</span> <span class="fu">sum</span>(part2 <span class="sc">&gt;</span> L1)</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>  (i <span class="sc">+</span> j) <span class="sc">/</span> (k <span class="sc">*</span> L)</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>NNtest <span class="ot">&lt;-</span> <span class="cf">function</span>(X,sizes,k){</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>X,<span class="at">statistic=</span>NN,<span class="at">R=</span>B,<span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> sizes,<span class="at">k=</span>k)</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>  T <span class="ot">&lt;-</span> <span class="fu">c</span>(b<span class="sc">$</span>t0,b<span class="sc">$</span>t)</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>  pv <span class="ot">&lt;-</span> <span class="fu">mean</span>(T<span class="sc">&gt;=</span>T[<span class="dv">1</span>])</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>T[<span class="dv">1</span>],<span class="at">p.value=</span>pv)</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,N,<span class="dv">3</span>)</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(L1<span class="sc">*</span>p),<span class="at">ncol=</span>p);</span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>  B1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(L2,<span class="dv">0</span>,<span class="dv">2</span>),<span class="fu">rnorm</span>(L2,<span class="dv">0</span>,<span class="dv">2</span>));</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>  C1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(A1,B1)</span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>  p1[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">NNtest</span>(C1,LL,k)<span class="sc">$</span>p.value</span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>  p1[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(C1,<span class="at">sizes=</span>LL,<span class="at">R=</span>B)<span class="sc">$</span>p.value</span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>  p1[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>A1,<span class="at">y=</span>B1,<span class="at">num.permutations =</span> B,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>powercomparison1 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p1<span class="sc">&lt;</span>alpha)</span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,N,<span class="dv">3</span>)</span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>  A2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(L1,<span class="dv">0</span>,<span class="dv">2</span>),<span class="fu">rnorm</span>(L1,<span class="dv">0</span>,<span class="dv">2</span>));</span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a>  B2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(L2,<span class="fl">1.5</span>,<span class="dv">3</span>),<span class="fu">rnorm</span>(L2,<span class="fl">1.5</span>,<span class="dv">3</span>));</span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>  C2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(A2,B2)</span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a>  p2[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">NNtest</span>(C2,LL,k)<span class="sc">$</span>p.value</span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a>  p2[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(C2,<span class="at">sizes=</span>LL,<span class="at">R=</span>B)<span class="sc">$</span>p.value</span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a>  p2[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>A2,<span class="at">y=</span>B2,<span class="at">num.permutations =</span> B,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a>powercomparison2 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p2<span class="sc">&lt;</span>alpha)</span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,N,<span class="dv">3</span>)</span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a>  A3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rt</span>(L1<span class="sc">*</span>p,<span class="dv">1</span>),<span class="at">ncol=</span>p);</span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a>  B3 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(L2),<span class="fu">rnorm</span>(L2,<span class="dv">1</span>,<span class="fl">1.5</span>));</span>
<span id="cb55-55"><a href="#cb55-55" aria-hidden="true" tabindex="-1"></a>  C3 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(A3,B3)</span>
<span id="cb55-56"><a href="#cb55-56" aria-hidden="true" tabindex="-1"></a>  p3[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">NNtest</span>(C3,LL,k)<span class="sc">$</span>p.value</span>
<span id="cb55-57"><a href="#cb55-57" aria-hidden="true" tabindex="-1"></a>  p3[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(C3,<span class="at">sizes=</span>LL,<span class="at">R=</span>B)<span class="sc">$</span>p.value</span>
<span id="cb55-58"><a href="#cb55-58" aria-hidden="true" tabindex="-1"></a>  p3[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>A3,<span class="at">y=</span>B3,<span class="at">num.permutations =</span> B,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb55-59"><a href="#cb55-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-60"><a href="#cb55-60" aria-hidden="true" tabindex="-1"></a>powercomparison3 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p3<span class="sc">&lt;</span>alpha)</span>
<span id="cb55-61"><a href="#cb55-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-62"><a href="#cb55-62" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,N,<span class="dv">3</span>)</span>
<span id="cb55-63"><a href="#cb55-63" aria-hidden="true" tabindex="-1"></a>L1<span class="ot">&lt;-</span><span class="dv">10</span>;L2<span class="ot">&lt;-</span><span class="dv">100</span>;L<span class="ot">&lt;-</span>L1<span class="sc">+</span>L2;LL<span class="ot">=</span><span class="fu">c</span>(L1,L2)</span>
<span id="cb55-64"><a href="#cb55-64" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb55-65"><a href="#cb55-65" aria-hidden="true" tabindex="-1"></a>  A4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(L1<span class="sc">*</span>p),<span class="at">ncol=</span>p);</span>
<span id="cb55-66"><a href="#cb55-66" aria-hidden="true" tabindex="-1"></a>  B4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(L2<span class="sc">*</span>p,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">ncol=</span>p);</span>
<span id="cb55-67"><a href="#cb55-67" aria-hidden="true" tabindex="-1"></a>  C4 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(A4,B4)</span>
<span id="cb55-68"><a href="#cb55-68" aria-hidden="true" tabindex="-1"></a>  p4[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">NNtest</span>(C4,LL,k)<span class="sc">$</span>p.value</span>
<span id="cb55-69"><a href="#cb55-69" aria-hidden="true" tabindex="-1"></a>  p4[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(C4,<span class="at">sizes=</span>LL,<span class="at">R=</span>B)<span class="sc">$</span>p.value</span>
<span id="cb55-70"><a href="#cb55-70" aria-hidden="true" tabindex="-1"></a>  p4[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>A4,<span class="at">y=</span>B4,<span class="at">num.permutations =</span> B,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb55-71"><a href="#cb55-71" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-72"><a href="#cb55-72" aria-hidden="true" tabindex="-1"></a>powercomparison4 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p4<span class="sc">&lt;</span>alpha)</span>
<span id="cb55-73"><a href="#cb55-73" aria-hidden="true" tabindex="-1"></a>powercomparison <span class="ot">&lt;-</span> <span class="fu">rbind</span>(powercomparison1,powercomparison2,powercomparison3,powercomparison4)</span>
<span id="cb55-74"><a href="#cb55-74" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(powercomparison) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;Energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>)</span>
<span id="cb55-75"><a href="#cb55-75" aria-hidden="true" tabindex="-1"></a>powercomparison</span></code></pre></div>
<pre><code>##                    NN Energy Ball
## powercomparison1 0.47   0.52 0.83
## powercomparison2 0.41   0.73 0.75
## powercomparison3 0.33   0.73 0.70
## powercomparison4 0.34   0.83 1.00</code></pre>
<p>As you can see, different methods have different power in different situations. Ball method performs well in the above situation.</p>
</div>
<div id="homework7" class="section level2">
<h2>Homework7</h2>
<p>Exercise 9.3 and 9.8 (pages 277-278, Statistical Computating with R).</p>
<p>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R &lt; 1.2\)</span>.</p>
<p><strong>9.3</strong></p>
<p><span class="math inline">\(-\infty &lt;x&lt; \infty\)</span> in the Cauthy distribution, so we choose the proposal distribution is normal <span class="math display">\[g( \cdot |X_t) \sim N(X_t,\sigma^2) , -\infty &lt;x&lt; \infty\]</span></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(theta,eta,x){   </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(theta <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="dv">1</span><span class="sc">/</span>(theta<span class="sc">*</span>pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>((x<span class="sc">-</span>eta)<span class="sc">/</span>theta)<span class="sc">^</span><span class="dv">2</span>)) )</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">2000</span>;</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n);</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">runif</span>(n);</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>A[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>);   </span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>i <span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">=</span><span class="dv">1</span>;eta<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){       </span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>  At <span class="ot">&lt;-</span> A[j<span class="dv">-1</span>]</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,At,<span class="dv">1</span>)</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>  H1 <span class="ot">&lt;-</span> <span class="fu">f</span>(theta,eta,B)<span class="sc">*</span><span class="fu">dnorm</span>(At,B,<span class="dv">1</span>)</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>  H2 <span class="ot">&lt;-</span> <span class="fu">f</span>(theta,eta,At)<span class="sc">*</span><span class="fu">dnorm</span>(B,At,<span class="dv">1</span>)</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(C[j]<span class="sc">&lt;=</span>H1<span class="sc">/</span>H2)</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>    A[j] <span class="ot">=</span> B</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>    A[j] <span class="ot">=</span> At</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">=</span> i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>burnin <span class="ot">&lt;-</span> <span class="dv">1001</span> </span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> A[burnin<span class="sc">:</span>n]</span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(X,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>))  </span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>q2 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>),<span class="at">df=</span><span class="dv">1</span>)   </span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">rbind</span>(q1,q2)</span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Q))</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="3%" />
<col width="10%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">10%</th>
<th align="right">20%</th>
<th align="right">30%</th>
<th align="right">40%</th>
<th align="right">50%</th>
<th align="right">60%</th>
<th align="right">70%</th>
<th align="right">80%</th>
<th align="right">90%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">q1</td>
<td align="right">-1.610004</td>
<td align="right">-0.9447575</td>
<td align="right">-0.5407671</td>
<td align="right">-0.2531220</td>
<td align="right">-0.0236688</td>
<td align="right">0.2240183</td>
<td align="right">0.4875767</td>
<td align="right">0.7889158</td>
<td align="right">1.301216</td>
</tr>
<tr class="even">
<td align="left">q2</td>
<td align="right">-3.077684</td>
<td align="right">-1.3763819</td>
<td align="right">-0.7265425</td>
<td align="right">-0.3249197</td>
<td align="right">0.0000000</td>
<td align="right">0.3249197</td>
<td align="right">0.7265425</td>
<td align="right">1.3763819</td>
<td align="right">3.077684</td>
</tr>
</tbody>
</table>
<p>As we can see, the deciles of the generated observations and the deciles of the standard Cauchy distribution are very close.</p>
<p><strong>9.8</strong></p>
<p>We choose <span class="math inline">\(a=1\)</span>, <span class="math inline">\(b=1\)</span>, <span class="math inline">\(n=10\)</span>, then use the Gibbs sampler to generate a chain with target joint density <span class="math inline">\(f(x,y)\)</span>.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fl">1e3</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>bi <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,M,<span class="dv">2</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span> ; b <span class="ot">&lt;-</span> <span class="dv">1</span> ; n <span class="ot">&lt;-</span> <span class="dv">10</span> </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>A[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)   </span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>M){    </span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> A[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  A[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">10</span>,y)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> A[i,<span class="dv">1</span>]</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  A[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> A[(bi<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>M,]    </span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(X)  </span></code></pre></div>
<pre><code>## [1] 5.2080000 0.5256165</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(X)</span></code></pre></div>
<pre><code>##            [,1]       [,2]
## [1,] 10.8255616 0.89847313
## [2,]  0.8984731 0.08827151</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(X)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 1.0000000 0.9191144
## [2,] 0.9191144 1.0000000</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X,<span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> From the final analysis of the chain, we can get some data properties.</p>
<p><strong>2.</strong></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>GR <span class="ot">&lt;-</span> <span class="cf">function</span>(fai){</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  fai <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(fai)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(fai)  </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(fai)  </span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  faibar <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(fai)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  Bn <span class="ot">&lt;-</span> n<span class="sc">*</span><span class="fu">var</span>(faibar)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  Wn <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">apply</span>(fai, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>))</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((Wn<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">+</span>(Bn<span class="sc">/</span>n))<span class="sc">/</span>Wn)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Firstly, we use the Gelman-Rubin method to monitor convergence of the chain in <span class="math inline">\(9.3\)</span>.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">2000</span>;</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">4</span>;</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>chain93 <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n);</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  C <span class="ot">&lt;-</span> <span class="fu">runif</span>(n);</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  A[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">20</span>; </span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  theta<span class="ot">=</span><span class="dv">1</span>;eta<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){         </span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>    At <span class="ot">&lt;-</span> A[j<span class="dv">-1</span>]</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>    B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,At,<span class="dv">1</span>)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>    H1 <span class="ot">&lt;-</span> <span class="fu">f</span>(theta,eta,B)<span class="sc">*</span><span class="fu">dnorm</span>(At,B,<span class="dv">1</span>)</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>    H2 <span class="ot">&lt;-</span> <span class="fu">f</span>(theta,eta,At)<span class="sc">*</span><span class="fu">dnorm</span>(B,At,<span class="dv">1</span>)</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(C[j]<span class="sc">&lt;=</span>H1<span class="sc">/</span>H2)</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>      A[j] <span class="ot">=</span> B</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>      A[j] <span class="ot">=</span> At</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>      i <span class="ot">=</span> i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(A)</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,m,n)</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>  Z[i,] <span class="ot">&lt;-</span> <span class="fu">chain93</span>()</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>fai <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(Z,<span class="dv">1</span>,cumsum))</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(fai))</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>  fai[i,] <span class="ot">&lt;-</span> fai[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(fai))</span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">GR</span>(fai))</span></code></pre></div>
<pre><code>## [1] 1.444076</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span>;</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">GR</span>(fai[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>n)], <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> As we can see, we haven’t get <span class="math inline">\(\hat R&lt;1.2\)</span>, so the chain in <span class="math inline">\(9.3\)</span> does not converge.</p>
<p>Secondly, we use the Gelman-Rubin method to monitor convergence of the chain in <span class="math inline">\(9.8\)</span>.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">2000</span>;</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">4</span>;</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>chain98 <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,M,<span class="dv">2</span>)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="dv">1</span> ; b <span class="ot">&lt;-</span> <span class="dv">1</span> ; n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  A[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)  </span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>M){    </span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> A[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>    A[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">10</span>,y)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> A[i,<span class="dv">1</span>]</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>    A[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(A)</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>Z1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,m,M)</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>Z2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,m,M)</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>  Q <span class="ot">&lt;-</span> <span class="fu">chain98</span>()</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> Q[,<span class="dv">1</span>]</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> Q[,<span class="dv">2</span>]</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>  Z1[i,] <span class="ot">&lt;-</span> c</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>  Z2[i,] <span class="ot">&lt;-</span> d</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>fai1 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(Z1,<span class="dv">1</span>,cumsum))</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(fai1))</span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>  fai1[i,] <span class="ot">&lt;-</span> fai1[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(fai1))</span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">GR</span>(fai1))</span></code></pre></div>
<pre><code>## [1] 1.729638</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>fai2 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(Z2,<span class="dv">1</span>,cumsum))</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(fai2))</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  fai2[i,] <span class="ot">&lt;-</span> fai2[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(fai2))</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">GR</span>(fai2))</span></code></pre></div>
<pre><code>## [1] 1.792563</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span>;</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>Xrhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,M)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>M)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  Xrhat[j] <span class="ot">&lt;-</span> <span class="fu">GR</span>(fai1[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Xrhat[(b<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>M)],<span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>Yrhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,M)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>M)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  Yrhat[j] <span class="ot">&lt;-</span> <span class="fu">GR</span>(fai2[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Yrhat[(b<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>M)], <span class="at">xlab=</span><span class="st">&quot;Y&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAVFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6ZmY6kNtmAABmADpmtv+QOgCQOjqQ2/+2ZgC2/7a2///bkDrbkJDb////tmb/25D//7b//9v///8CP27IAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAG2klEQVR4nO3djXqiOBiGYdrq7IyuM3Xr1FrO/zxXQK0WkwdCEj7kfa5rf8Ug92BAi7Yolbdi7AdgPQFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIigxUTKaxgDou1uMRpskuUP8/wySZBQrZy1NkFShsHkiQUaDQmTJ+EwEaT2gqQKMJ2QQacj4SOdtAV/8qoJtbr1BGFjIJdEsyrlBmoG5TigNoFKEJ7EHj7kKWgb7/9yhCFoHaHAK6vc0JNILQNIBGFDIIdNdCQFc3Ccg/3H2LsYTsAt3/vwJySYw1TU8GaKxdaHpAmYXMAjlvmDuQm0FAzQ1uhlGEBARZBfLdllXIGpDXYAZAl2O1gAKHG8CXJgFBxoA6PgEzCvUHOvz7Wv9z//wWf70EMCWgnQ9od9yIjW8pP5D7UWQX6gu0/ToOrdwL755ey8N6UfYF4s03D/S1B3n6/L2q//7yPkegDh3W9dOr3L68xwbKLhQAdFg3D9E9BzV70LHtIgjI+zjsA1X7xaL8WG7cC59ZjpZ9gLpsfO5pOmAOWq/KfTW7HP9ytmuOYcd9KTZQ7l0oBGhTfvzzVv8Veb2PAVRNMNWRLB0Q3TWrUMAcVE0w25X/KXY8XVp8/j6fLXZd74MAHY9Nntm3rsLbFotmwuq83o5bnneaTnIeVB/m90/VCaVrPxvylur0geoTxebFrOslrQeIH4pxoHpu4RPF4D2ow2PJKBRyosjvc1zmoMs59XkU3wTyIEDOefe6kKNY9822DuR5jTFkvT02O6NQyIniIs16HwXI/zL1ez1ezffZ6HxCPYHOb3X4j2Jh630IoITr7bXNEwH6/IPvvnYfrt82ZxMSEK1oyIIpgLref9JAHabyoUDZhNLsQc53Wj3DzQqIzyZbw/Xd4IkDlXvnqzDHcL03OJOQmUlaQDBc780t8ggNAPob9aVG/63NI9QbaHc6cvOBqt96AzY2i1BfoOqN1O3L+3ES9l3+ErDeIUApiXoC1Yfvw3qzK56Cp5+76w3a0hxCvd/uWFVKP4vAN82cWxS2oRmEegNVpzfbYU+ve+sN3MwiOVEYkO+nzmHrDd3IIjVRGNDwd6VjAd0KJSAyAjRgAxMLTR8o8dPMyJv2A7fODlCq9Q7dukcHGr51AuIRTUzSidYb54/fwmE+0XoTnugNzQRQyjPhoQkIEhBkCSjuGiJlAcjyDiQgSkBQZqB7r5lM+1jYgwQEwwkIhjPtYwDI9g6UCqj6PMfHsnD/eHHmQLXPj1fP5xYuwxn3SQNU//y1eWcfPw41U6DN+YNQ+IG6WQLVe8+u0x5k3ScR0GH9/Hb1sUPPcDMFqi7irHP+hPE03J1XHsYa+TzIvM/IQPZ3oFRHMbw+ph5uAj6pgH4t4RKruQOtyp3/Kr1quCn4JDyTrg5kbqNiIj4pgcrayH0mLaB7o1ypTMInN9DNcFPwGfc8aAI+Y59J2y81kPObFyZTYqA4g3ZcbpTFAhePO6iA4iwnIIuLBS4ed9BHA+p8Pf5cgTp/oHW2QF2/x2u+QPjNC/0GfUCg+SUgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFB8YH2nuvMz2+6La6X89/BV/NrdqIO2So6UHV9p/Maz7K5Dv1mObiDp+qa0shDtosN1FxH7f4emfMF1pfl6A7uzteYRBzyTrGBmm/Gd/+qzd3i23J0B2f7YtXQxBvyXtGB6v3d/ctatz+L+psIL8vRHXw194o6ZKvYQM1T3zkBNNeBbldfy8Ed/CurDOIO2Soz0Gmh57d4QHGHbJX7KdYstNxEfIpFHbJV7km6WejHa5QZ9Roo0pCtMh/mm8e+P30mZugxuQaKO2Sr3CeK9cPeruKc1Z2OYjGHbBX/pcbOf5pf/drtzc1ycAdPp6dYzCFb6cUqJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJBtoPN1rMs4V2qEZBuoulKzjHapT1DGgerv+O7w1WDpsg70sVyNugOZBzruQv+NuQPZB/pYFsN/w/KAzAOVu07fhpEs+0CxLjYMTECQgCABQQKC7AONnIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIOh/xK8Lg70mVGwAAAAASUVORK5CYII=" /><!-- --> As we can see, we haven’t get <span class="math inline">\(\hat R&lt;1.2\)</span>, so the chain in <span class="math inline">\(9.8\)</span> does not converge, too.</p>
</div>
<div id="homework8" class="section level2">
<h2>Homework8</h2>
<p>Exercises 11.3 and 11.5 (pages 353-354, Statistical Computing with R)</p>
<p>Suppose <span class="math inline">\(T_1,...,T_n\)</span> are <span class="math inline">\(i.i.d.\)</span> samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i = T_iI(T_i \le \tau)+\tau I(T_i &gt; \tau)\)</span>,<span class="math inline">\(i = 1,...,n\)</span>. Suppose <span class="math inline">\(\tau = 1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: <span class="math display">\[0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85\]</span> Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data MLE (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution)</p>
<p><strong>11.3</strong></p>
<p><strong>(a)</strong> As required, we need to compute <span class="math display">\[Y_k = \frac{(-1)^k}{k!2^k}\frac{{||a||^{2k+2}}}{(2k+1)(2k+2)}\frac{\Gamma(\frac{d+1}{2})\Gamma(k+\frac{3}{2})}{\Gamma(k+\frac{d}{2}+1)}\]</span></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>Yk <span class="ot">&lt;-</span> <span class="cf">function</span>(k,a){</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  yk1 <span class="ot">=</span> (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">/</span><span class="fu">factorial</span>(k)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">^</span>k)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">=</span> <span class="fu">length</span>(a)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  ena <span class="ot">=</span> <span class="dv">0</span>           </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d){</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    ena <span class="ot">&lt;-</span> ena <span class="sc">+</span> a[i]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  ena <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(ena)</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  yk2 <span class="ot">=</span> (ena<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>))<span class="sc">/</span>((<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>))</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  yk3 <span class="ot">=</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="fl">+1.5</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(yk1 <span class="sc">*</span> yk2 <span class="sc">*</span> yk3)</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>(b)</strong> Then, we need to compute <span class="math display">\[\sum_{k=0}^{\infty}Y_k\]</span></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>SumofYk <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">0</span>; sumofyk<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">abs</span>(<span class="fu">Yk</span>(i,a)) <span class="sc">&gt;</span> <span class="fl">0.00000001</span>) {    </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>      sumofyk<span class="ot">=</span>sumofyk <span class="sc">+</span> <span class="fu">Yk</span>(i, a);</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>      i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span>;</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sumofyk)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>(c)</strong></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">SumofYk</span>(a)</span></code></pre></div>
<pre><code>## [1] 1.532164</code></pre>
<p>As we can see, the sum of <span class="math inline">\(a = {(1,2)}^T\)</span> is <span class="math inline">\(1.532164\)</span>.</p>
<p><strong>11.5</strong></p>
<p>If we make <span class="math inline">\(X_{k-1}\)</span> equal to the left side of the equation, we need to solve the equation <span class="math display">\[X_{k-1} = X_k\]</span> As we all know, the probability density function of <span class="math inline">\(t(n)\)</span> is <span class="math display">\[f(x)=\frac{\Gamma(\frac{n+1}{2})}{\sqrt{n\pi}\Gamma(\frac{n}{2})}(1+\frac{x^2}{n})^{-\frac{n+1}{2}}\]</span> And the probability density function of <span class="math inline">\(t(n)\)</span> is symmetric about the y-axis. So, <span class="math display">\[X_{k-1} = X_k\]</span> is equivalent to <span class="math display">\[S_{k-1} = S_k\]</span> Where <span class="math inline">\(S_k\)</span> has been defined in <span class="math inline">\(11.4\)</span>.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>aoff <span class="ot">&lt;-</span> <span class="cf">function</span>(k){</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">uniroot</span>( <span class="cf">function</span>(a) {<span class="fu">pt</span>(<span class="fu">sqrt</span>((a<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),<span class="at">df=</span>k<span class="dv">-1</span>)<span class="sc">-</span><span class="fu">pt</span>(<span class="fu">sqrt</span>((a<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),<span class="at">df=</span>k)}</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>                ,<span class="fu">c</span>(<span class="fl">0.00002</span>, <span class="fu">sqrt</span>(k)<span class="sc">-</span><span class="fl">0.00002</span>))<span class="sc">$</span>root</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">length</span>(N)</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">numeric</span>(L)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>L){</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  X[j]<span class="ot">=</span><span class="fu">aoff</span>(N[j])</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">cbind</span>(N,X)</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Y) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;k&quot;</span>,<span class="st">&quot;a&quot;</span>)</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>Y</span></code></pre></div>
<pre><code>##          k         a
##  [1,]    4  1.492103
##  [2,]    5  1.533549
##  [3,]    6  1.562768
##  [4,]    7  1.584421
##  [5,]    8  1.601182
##  [6,]    9  1.614541
##  [7,]   10  1.625383
##  [8,]   11  1.634409
##  [9,]   12  1.642033
## [10,]   13  1.648539
## [11,]   14  1.654192
## [12,]   15  1.659098
## [13,]   16  1.663452
## [14,]   17  1.667288
## [15,]   18  1.670736
## [16,]   19  1.673841
## [17,]   20  1.676588
## [18,]   21  1.679139
## [19,]   22  1.681461
## [20,]   23  4.795812
## [21,]   24  4.898959
## [22,]   25  4.999980
## [23,]  100  9.999980
## [24,]  500 22.360660
## [25,] 1000 31.622757</code></pre>
<p>As we can see, the solution of <span class="math inline">\(11.5\)</span> is equal to the solution of <span class="math inline">\(11.4\)</span>. Because the two equations are also equivalent.</p>
<p><strong>2.</strong></p>
<p>The probability density function of <span class="math inline">\(Exp(\lambda)\)</span> is <span class="math display">\[f(y)=\lambda e^{-\lambda y},    y&gt;0\]</span> And we can get <span class="math display">\[\int_{1}^{\infty}\lambda e^{-\lambda y}\,dy=e^{-\lambda}\]</span> As we can see, <span class="math inline">\(7\)</span> of the observed <span class="math inline">\(Y_i\)</span> values less than <span class="math inline">\(1\)</span>. We call it <span class="math inline">\(y_i,i=1,..,7\)</span>.</p>
<p>Firstly, we consider the <span class="math inline">\(MLE\)</span> of the observed data. <span class="math display">\[L(Y;\lambda)=C_{10}^3*(e^{-\lambda})^3 \prod_{i=1}^{7}(\lambda e^{-\lambda y_i})\]</span> <span class="math display">\[logL(Y;\lambda)=log(C_{10}^3)-3\lambda+7log\lambda-\lambda\sum_{i=1}^{7}y_i\]</span> After the derivation, we can get <span class="math display">\[\hat \lambda=\frac{7}{\sum_{i=1}^{7}y_i+3}=\frac{28}{27} \approx 1.037037\]</span></p>
<p>Secondly, use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>.</p>
<p>(1)Initiate <span class="math inline">\(\lambda\)</span> with <span class="math inline">\(\lambda _0\)</span>.</p>
<p>(2)Complete data likelihood: <span class="math display">\[L(\lambda;Y)=\prod_{i=1}^{10}(\lambda e^{-\lambda y_i})\]</span> <span class="math display">\[logL(\lambda;Y)=10log\lambda-\lambda\sum_{i=1}^{10}y_i\]</span></p>
<p>(3)E-step: <span class="math display">\[I_0=E_{\lambda _0}[logL|Y]=10log\lambda-\lambda\sum_{i=1}^{k}y_i-\lambda\sum_{i=k+1}^{10}(\int_1^{\infty}y_ie^{-\lambda_0(x-1)}\,dy_i) \]</span> <span class="math display">\[I_0=10log\lambda-\lambda\sum_{i=1}^{k}y_i-\lambda(10-k)(\frac{1}{\lambda_o}+1)\]</span></p>
<p>(4)M-step: <span class="math display">\[maxI_0\]</span> We can get <span class="math display">\[\lambda_1=\frac{10}{\sum_{i=1}^{k}y_i+(10-k)(\frac{1}{\lambda_o}+1)}\]</span></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">/</span>(<span class="fu">sum</span>(x)<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span>A)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="fu">abs</span>(B<span class="sc">-</span>A)<span class="sc">&gt;</span><span class="fl">0.000000000001</span>){</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> B</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">/</span>(<span class="fu">sum</span>(x)<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span>A)</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>B</span></code></pre></div>
<pre><code>## [1] 1.037037</code></pre>
<p>As we can see, the results of E-M and the observed data MLE are the same.</p>
</div>
<div id="homework9" class="section level2">
<h2>Homework9</h2>
<p>Exercises 1 and 5 (page 204, Advanced R).Excecises 1 and 7 (page 214, Advanced R)</p>
<p><strong>P204 1</strong></p>
<p><span class="math inline">\(trims &lt;- c(0, 0.1, 0.2, 0.5)\)</span></p>
<p><span class="math inline">\(x &lt;- rcauchy(100)\)</span></p>
<p><span class="math inline">\(lapply(trims, function(trim) mean(x, trim = trim))\)</span></p>
<p><span class="math inline">\(lapply(trims, mean, x = x)\)</span></p>
<p>Because both of the two invocations of lapply() mean: after arranging vector <span class="math inline">\(x\)</span> in order, cut off <span class="math inline">\(0\%,10\%,20\%,50\%\)</span> of the Outliers at the beginning and end, and find the mean value of the remaining numbers.</p>
<p>And the first parameter of the <span class="math inline">\(mean()\)</span> can be provided by the third parameter of <span class="math inline">\(lapply()\)</span>, so the following two invocations of lapply() are equivalent.</p>
<p><strong>P204 5</strong></p>
<p>As for Exercise 3:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(mtcars)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp,</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(formulas)</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>,n1) </span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)){</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>  A1[[j]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[j]])</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>A2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, lm)</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(A1, rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(A2, rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<p>As for Exercise 4:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(bootstraps)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>B1 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="fu">length</span>(bootstraps)) </span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="fu">seq_along</span>(bootstraps)){</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  B1[[j]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, bootstraps[[j]])</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>B2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, lm, <span class="at">formula =</span> mpg <span class="sc">~</span> disp)</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(B1, rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.6157021
## 
## [[2]]
## [1] 0.7426137
## 
## [[3]]
## [1] 0.7090495
## 
## [[4]]
## [1] 0.5515627
## 
## [[5]]
## [1] 0.7422951
## 
## [[6]]
## [1] 0.7390564
## 
## [[7]]
## [1] 0.7944183
## 
## [[8]]
## [1] 0.7864715
## 
## [[9]]
## [1] 0.8016978
## 
## [[10]]
## [1] 0.6228064</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(B2, rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.6157021
## 
## [[2]]
## [1] 0.7426137
## 
## [[3]]
## [1] 0.7090495
## 
## [[4]]
## [1] 0.5515627
## 
## [[5]]
## [1] 0.7422951
## 
## [[6]]
## [1] 0.7390564
## 
## [[7]]
## [1] 0.7944183
## 
## [[8]]
## [1] 0.7864715
## 
## [[9]]
## [1] 0.8016978
## 
## [[10]]
## [1] 0.6228064</code></pre>
<p><strong>P214 1</strong></p>
<p><strong>a</strong>To compute the standard deviation of every column in a numeric data frame. Assume <span class="math inline">\(A\)</span> is a numeric data frame. Then, we can use <span class="math display">\[vapply(A,sd,numric(1))\]</span> <strong>b</strong>To compute the standard deviation of every numeric column in a mixed data frame. Assume <span class="math inline">\(B\)</span> is a mixed data frame. Then, we can use <span class="math display">\[vapply(B[vapply(B, is.numeric, logical(1))],sd,numeric(1))\]</span></p>
<p><strong>P214 7</strong></p>
<p>Firstly, What is vapply? <span class="math inline">\(vapply(X,FUN,FUN.VALUE,…,USE.NAMES=TRUE)\)</span> similar to sapply, but has a pre-specified type of return value, so it can be safer (and sometimes faster) to use.</p>
<p>Secondly, what is sapply? <span class="math inline">\(sapply(X,FUN,…,simplify=TRUE,USE.NAMES=TRUE)\)</span> a user-friendly version and wrapper of lapply by default returning a vector, matrix or, if simplify = “array”, an array if appropriate, by applying <span class="math inline">\(simplify2array()\)</span>. <span class="math inline">\(sapply(x, f, simplify = FALSE, USE.NAMES = FALSE)\)</span> is the same as <span class="math inline">\(lapply(x, f)\)</span>.</p>
<p>And <span class="math inline">\(mcsapply()\)</span> is a multicore version of <span class="math inline">\(sapply()\)</span>.I can’t implement a <span class="math inline">\(mcvapply()\)</span>.</p>
</div>
<div id="homework10" class="section level2">
<h2>Homework10</h2>
<p>(1)Write an Rcpp function for Exercise 9.8 (page 278, StatisticalComputing with R).</p>
<p>(2)Compare the corresponding generated random numbers with pure R language using the function “qqplot”.</p>
<p>(3)Compare the computation time of the two functions with the function “microbenchmark”.</p>
<p>(4)Comments your results.</p>
<p><strong>1.</strong> pure R language:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>pureR <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b,n,M){</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,M,<span class="dv">2</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  A[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)   </span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>M){     </span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> A[j<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>    A[j,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">10</span>,y)</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> A[j,<span class="dv">1</span>]</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>    A[j,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(A)</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Rcpp function:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;NumericMatrix CppFun(double a, double b, int n, int M) {</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="st">            NumericMatrix A(M,2); </span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="st">            A(0, 0) = A(0, 1) = 0;</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="st">            double x; double y;</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="st">            for(int j = 1; j &lt; M; j++)</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="st">            {</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="st">              y = A(j-1, 1);</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="st">              A(j, 0) = rbinom(1, n, y)[0];</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a><span class="st">              x = A(j, 0);</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a><span class="st">              A(j, 1) = rbeta(1, x+a, n-x+b)[0];</span></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a><span class="st">            return A;</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span>)</span></code></pre></div>
<p><strong>2.</strong></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span>; b <span class="ot">&lt;-</span> <span class="dv">1</span>; n <span class="ot">&lt;-</span> <span class="dv">10</span>; M <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">*</span><span class="fl">1e3</span>;     </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>Z1 <span class="ot">&lt;-</span> <span class="fu">pureR</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">5</span><span class="sc">*</span><span class="fl">1e3</span>)       </span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>Z2 <span class="ot">&lt;-</span> <span class="fu">CppFun</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">5</span><span class="sc">*</span><span class="fl">1e3</span>)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))       </span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(Z1[<span class="dv">1001</span><span class="sc">:</span>M,<span class="dv">1</span>],Z2[<span class="dv">1001</span><span class="sc">:</span>M,<span class="dv">1</span>],<span class="at">xlab=</span><span class="st">&#39;pure R language_x&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Rcpp function_x&#39;</span>)</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(Z1[<span class="dv">1001</span><span class="sc">:</span>M,<span class="dv">2</span>],Z2[<span class="dv">1001</span><span class="sc">:</span>M,<span class="dv">2</span>],<span class="at">xlab=</span><span class="st">&#39;pure R language_y&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Rcpp function_y&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>3.</strong></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>timecompare <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">R=</span><span class="fu">pureR</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">5</span><span class="sc">*</span><span class="fl">1e3</span>),<span class="at">Rcpp=</span><span class="fu">CppFun</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">5</span><span class="sc">*</span><span class="fl">1e3</span>))  </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(timecompare)[, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)])</span></code></pre></div>
<pre><code>##   expr       lq   median       uq
## 1    R 15.66685 20.57125 21.07555
## 2 Rcpp  1.62275  1.63025  1.64410</code></pre>
<p><strong>4.</strong> As we can see, the computation time of the Rcpp function is much less than pure R language. So the Rcpp function is more efficient.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
